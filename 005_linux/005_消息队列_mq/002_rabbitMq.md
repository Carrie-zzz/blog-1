# RabbitMQ #
1. RabbitMQ是用erlang
2. 天生就是一门分布式语言,集群非常方便，但其本身并不支持负载均衡
3. 集群中各节点是经由过程一个magic cookie来实现的
4. RabbitMQ的集群节点包括内存节点、磁盘节点(持久化)
	内存节点就是将所有数据放在内存，磁盘节点将数据放在磁盘上
	一个集群至少要有一个磁盘节点
	一个rabbitmq集群中可以共享user，vhost，exchange等
	所有的数据和状态都是必须在所有节点上复制的
	通过magic cookie认证节点

# RabbitMQ 集群模式 #
1. 普通模式：默认的集群模式。
	1. Queue来说，**消息实体**只存在于其中一个节点，
		1. consumer从B节点拉取时,RabbitMQ会临时在A、B间进行消息传输，把A中的**消息实体**取出并经过B发送给consumer
	2. 当A节点故障后，B节点无法取到A节点中还未消费的消息实体,
		1. 如果做了队列持久化或消息持久化，那么得等A节点恢复，然后才可被消费
			1. 并且在A节点恢复之前其它节点不能再创建A节点已经创建过的持久队列
		2. 如果没有持久化的话，消息就会失丢
	3. 更适合非持久化队列 
		1. 只有该队列是非持久的，客户端才能重新连接到集群里的其他节点，并重新创建队列
	4. 
2. 镜像模式：把需要的队列做成镜像队列。
	1. **消息实体**会主动在镜像节点间同步(多个节点),而不是在consumer取数据时B节点临时拉取
	2. 降低系统性能,大量的消息进入，集群内部的网络带宽将会被这种同步通讯大大消耗掉
	3. 可靠性要求较高的场合中适用