# 关联查询 #
1. 班级HxClass , 学生 HxStudent
2. 1个班	 1:n	多个学生
3. 1个学生 1:1  一个班级
4. 多方建立外键

## 步骤 ##
1. sql
	create table HxClass
	(
		id int primary key auto_increment,
		name varchar(32),
		createTime datetime 
	);

	insert into HxClass values(null,'1701',SYSDATE());
	insert into HxClass values(null,'1702',now());
	insert into HxClass values(null,'1703', CURRENT_TIMESTAMP);


	create table HxStudent
	(
		id int primary key auto_increment,
		name VARCHAR(32),
		sex int , #1 男 2女
		birthday date,
		classId int , # 外键
		foreign key(classId) 
		REFERENCES HxClass(id)
	)


	insert into hxstudent VALUES(null,"张三1",1,NOW(),1);
	insert into hxstudent VALUES(null,"李四1",1,NOW(),1);
	insert into hxstudent VALUES(null,"王五1",1,NOW(),1);
	
	
	insert into hxstudent VALUES(null,"张三2",1,NOW(),2);
	insert into hxstudent VALUES(null,"李四2",1,NOW(),2);
	insert into hxstudent VALUES(null,"王五2",1,NOW(),2);
2. 实体类
	public class HxClass implements Serializable {
		private int id;
		private String name;// 班级名
		private Date createTime;// 创建日期
		private List<HxStudent> list;
	}

	public class HxStudent implements Serializable {
		private int id;
		private String name;
		private Date birthday;// 生日
		private int sex;// 性别
		private int classId;// 外键
		private HxClass hxClass;
	}


3. 配置文件
4. 映射文件
	1. HxClassMapper.xml

5. 一对一:
		* 一个学生对应一个班级
		* 查询id为1的学生的信息(班级)(需要关联hxclass表)
			* select a.*,b.id cId, b.name className ,b.createTime from hxstudent a,hxclass b where a.classId=b.id and a.id=1;
		* 接口类:HxStudentMapper
			* public HxStudent selectById(Integer id);
		* 映射文件
			* 传统: 虽然后classId,但是hxClass没有值(不知道怎么存放查询结果)
				<select id="selectById" parameterType="java.lang.Integer" resultType="hxStudent">
					select a.*,b.id cId, b.name className ,b.createTime from hxstudent a,hxclass b where a.classId=b.id and a.id=#{id};
				</select>
			* 一对一关联映射
				* 自定义返回结果 resultMap
						<!-- 
						resultMap:自定义输出参数类型
							* type 返回值类型,,相当于  resultType 输出参数
							* id   resultMap的唯一标识
						id		:id的映射
							* column 	表的列名(一定是查询后结果的列名,如果select起了别名,就应该用别名)
							* property  bean的属性名
						result	:普通字段的映射
							
						association	: 联系:指定关联的一方 ,就是外键指向的类
							* property: bean中属性类的变量名
							* javaType: 指定当前bean中属性类的型
							* 关联里面也要一一指定
							* 将关联查询信息映射到pojo对象中的属性类中。
						 -->	
						<resultMap type="hxStudent" id="baseResultMap">
							<id column="id" property="id"/>
							<result column="name" property="name" />
							<result column="birthday" property="birthday" />
							<result column="sex" property="sex" />
							<result column="classId" property="classId" />
							<!-- 联系:指定关联的一方 -->
							<association   property="hxClass" javaType="com.huaxin.bean.HxClass">
								<id column="cId" property="id"/>
								<result column="className" property="name" />
								<result column="createTime" property="createTime" />
							</association>
						</resultMap>
	
						<select id="selectById" parameterType="java.lang.Integer" resultMap="baseResultMap">
						select a.*,b.id cId, b.name className ,b.createTime from hxstudent a,hxclass b where a.classId=b.id and a.id=#{id};
					</select>
6. 一对多
	* 一个班级多个学生
	* 查询班级为一个所有信息
		select a.*,b.id cId, b.name className ,b.createTime from hxstudent a,hxclass b where a.classId=b.id and b.id=1;
	* 接口类:HxClassMapper
		* public HxClass selectById(Integer id);
	* 映射文件
		* 传统: 虽然后classId,但是hxClass没有值(不知道怎么存放查询结果,报错)
			<select id="selectById" parameterType="java.lang.Integer" resultType="hxStudent">
				select a.*,b.id cId, b.name className ,b.createTime from hxstudent a,hxclass b where a.classId=b.id and b.id=#{id};
			</select>
		* 一对多关联映射	
				<resultMap type="hxClass" id="baseResultMap">
					<id column="cId" property="id"/>
					<result column="className" property="name" />
					<result column="createTime" property="createTime" />
				<!-- 
					collection	:集合,指定关联的一方
						* property bean属性名
						* ofType   lists集合的泛型类型	 ,com.huaxin.bean.HxStudent 可以用别名
				 -->
				<collection property="hxStudents" ofType="hxStudent" > 
					<id column="id" property="id"/>
					<result column="name" property="name" />
					<result column="birthday" property="birthday" />
					<result column="sex" property="sex" />
					<result column="classId" property="classId" />
				</collection>
			</resultMap>

				// 一对
				@Test
				public void testResultMap2() {
					SqlSession openSession = sqlSessionFactory.openSession();
					HxClassMapper mapper = openSession.getMapper(HxClassMapper.class);
					HxClass selectById = mapper.selectById(1);
					System.out.println(selectById);
				}